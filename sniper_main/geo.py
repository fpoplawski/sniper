# Autogenerated airports dictionary and distance calculation
# Coordinates from https://github.com/datasets/airport-codes (CC0)

from __future__ import annotations

from math import radians, sin, cos, sqrt, atan2

import logging

logger = logging.getLogger(__name__)

# At least 500 airport entries. Format: IATA -> (latitude, longitude)
AIRPORTS = {
    "WKK": (59.2826004028, -158.617996216),
    "HIR": (-9.428, 160.054993),
    "MUA": (-8.32797, 157.263),
    "INU": (-0.547458, 166.919006),
    "AXF": (38.74831, 105.58858),
    "VMU": (-7.49686002731, 144.819900513),
    "BUA": (-5.4223198890686035, 154.67300415039062),
    "OPU": (-8.05000019073, 142.932998657),
    "CMU": (-6.024290084838867, 144.9709930419922),
    "DAU": (-9.08676, 143.207993),
    "GKA": (-6.081689834590001, 145.391998291),
    "GUR": (-10.3114995956, 150.333999634),
    "PNP": (-8.80453968048, 148.309005737),
    "HKN": (-5.463846, 150.407327),
    "KMA": (-7.96361017227, 145.770996094),
    "KVG": (-2.57940006256, 150.807998657),
    "MAG": (-5.20707988739, 145.789001465),
    "HGU": (-5.828212, 144.299412),
    "MDU": (-6.14774, 143.656998),
    "MAS": (-2.06189, 147.423996),
    "LAE": (-6.569803, 146.725977),
    "POM": (-9.443380355834961, 147.22000122070312),
    "RAB": (-4.34046, 152.380005),
    "VAI": (-2.6926, 141.3028),
    "WBM": (-5.635293, 143.892231),
    "WWK": (-3.58383011818, 143.669006348),
    "ZXT": (40.494884, 49.977065),
    "BCW": (-21.8533, 35.438301),
    "JAM": (42.454899, 26.3522),
    "JEG": (68.721802, -52.784698),
    "UAK": (61.1605, -45.425999),
    "GOH": (64.191066, -51.67914),
    "JAV": (69.243202, -51.057098),
    "KUS": (65.573601, -37.1236),
    "SFJ": (67.010446, -50.715294),
    "JHS": (66.951302, -53.729301),
    "THU": (76.531197, -68.703201),
    "AEY": (65.656573, -18.072018),
    "EGS": (65.2833023071289, -14.401399612426758),
    "HFN": (64.295601, -15.2272),
    "HZK": (65.952301, -17.426001),
    "IFJ": (66.058098, -23.1353),
    "KEF": (63.985001, -22.6056),
    "RKV": (64.128732, -21.93759),
    "SIJ": (66.137847, -18.908157),
    "VEY": (63.42430114746094, -20.278900146484375),
    "PRN": (42.5728, 21.035801),
    "VDC": (-14.907885, -40.914804),
    "BTZ": (5.79, 101.15),
    "TXC": (54.439999, 30.2967),
    "CUK": (17.735015, -88.032862),
    "CYC": (17.683792, -88.044985),
    "CZH": (18.3822, -88.411903),
    "DGA": (16.98251, -88.230988),
    "PND": (16.1024, -88.808296),
    "SJX": (18.3561, -88.130798),
    "SPR": (17.9139, -87.9711),
    "TZA": (17.517239, -88.195775),
    "BZB": (-21.5411, 35.4729),
    "YAA": (52.451501, -125.303776),
    "XQU": (49.337456, -124.393086),
    "YZA": (50.775258, -121.321314),
    "ZEL": (52.185001, -128.156994),
    "HSC": (24.9786, 113.420998),
    "JGS": (26.856899, 114.737),
    "WHN": (30.25521, 114.062805),
    "NAY": (39.48595, 116.37236),
    "DDR": (28.604567, 86.798),
    "HQL": (37.661333, 75.288877),
    "APJ": (30.3975, 81.138611),
    "YAG": (48.655749, -93.44349),
    "YAH": (53.754699707, -73.6753005981),
    "YAM": (46.483216, -84.508467),
    "XKS": (53.52470016479492, -88.6427993774414),
    "YAY": (51.391909, -56.08321),
    "YAZ": (49.079833, -125.775583),
    "YBC": (49.1325, -68.204399),
    "QBC": (52.387501, -126.596001),
    "YBY": (54.304199, -110.744003),
    "YBG": (48.331908, -70.992909),
    "YBK": (64.29889678960001, -96.077796936),
    "YBL": (49.950802, -125.271004),
    "YBR": (49.91, -99.951897),
    "YBX": (51.4436, -57.185299),
    "YCB": (69.1081008911, -105.138000488),
    "YCC": (45.092637, -74.567724),
    "YCD": (49.05497, -123.869863),
    "YCE": (43.285599, -81.508301),
    "YCG": (49.296398, -117.632004),
    "YCH": (47.007801, -65.449203),
    "YCL": (47.990799, -66.330299),
    "YCN": (49.10559844970703, -81.01360321044922),
    "YCQ": (55.687198638916016, -121.62699890136719),
    "YDA": (64.04309844970703, -139.1280059814453),
    "YDB": (61.371101, -139.041),
    "YDF": (49.2108, -57.391399),
    "XRR": (61.9706001282, -132.42300415),
    "YDN": (51.1008, -100.052002),
    "YDO": (48.7785, -72.375),
    "YDQ": (55.741245, -120.183263),
    "YEG": (53.3097, -113.580002),
    "YEL": (46.351398468, -82.5614013672),
    "YEM": (45.842435, -81.857595),
    "YEN": (49.2103004456, -102.966003418),
    "YET": (53.578899383499994, -116.464996338),
    "YEV": (68.30419921880001, -133.483001709),
    "YEY": (48.563903, -78.249702),
    "YFB": (63.756402, -68.555801),
    "YFC": (45.868900299072266, -66.53720092773438),
    "YFE": (48.74610137939453, -69.09719848632812),
    "YTM": (46.409401, -74.779999),
    "YFR": (61.1808013916, -113.690002441),
    "YFS": (61.76020050048828, -121.23699951171875),
    "YGK": (44.2253, -76.596901),
    "YGL": (53.625301361083984, -77.7042007446289),
    "YGM": (50.62810134887695, -97.04329681396484),
    "YGP": (48.774915, -64.481893),
    "YGQ": (49.77830123901367, -86.93939971923828),
    "YGR": (47.425242, -61.778612),
    "YGV": (50.281898, -63.611401),
    "YGW": (55.281898498535156, -77.76529693603516),
    "YHD": (49.831699, -92.744202),
    "YHF": (49.71419906616211, -83.68609619140625),
    "YHM": (43.173599243199995, -79.93499755859999),
    "YHN": (49.19309997558594, -84.75890350341797),
    "YHT": (60.7892, -137.546005),
    "YHU": (45.517502, -73.416901),
    "YHY": (60.8396987915, -115.782997131),
    "YHZ": (44.8807983398, -63.5085983276),
    "YIB": (48.7738990784, -91.6386032104),
    "YDG": (44.5458450365, -65.7854247093),
    "YIF": (51.2117, -58.658298),
    "YIV": (53.857200622558594, -94.65360260009766),
    "YJF": (60.235801696799996, -123.46900177),
    "YJN": (45.29439926147461, -73.28109741210938),
    "YJT": (48.544201, -58.549999),
    "YKA": (50.703038, -120.448641),
    "YKF": (43.4608, -80.378601),
    "YKJ": (57.256099700927734, -105.61799621582031),
    "YKL": (54.805301666259766, -66.8052978515625),
    "YKD": (44.201401, -81.606697),
    "YKX": (48.21030044555664, -79.98139953613281),
    "YKY": (51.5175018311, -109.180999756),
    "YLD": (47.81999969482422, -83.3467025756836),
    "YLJ": (54.125301361083984, -108.52300262451172),
    "YLL": (53.3092, -110.072998),
    "YLR": (56.513301849365234, -99.98529815673828),
    "YLK": (44.485056, -79.554663),
    "YLT": (82.517799, -62.280602),
    "YLW": (49.9561, -119.377998),
    "YMA": (63.61640167236328, -135.8679962158203),
    "YME": (48.85689926147461, -67.45330047607422),
    "YMG": (49.083900451660156, -85.86060333251953),
    "YMJ": (50.330299377441406, -105.55899810791016),
    "YML": (47.59749984741211, -70.2238998413086),
    "YMM": (56.653301239, -111.222000122),
    "YMO": (51.291099548339844, -80.60780334472656),
    "YMT": (49.77190017700195, -74.5280990600586),
    "YMX": (45.679501, -74.038696),
    "YNA": (50.190114, -61.78898),
    "YND": (45.521702, -75.563599),
    "YLY": (49.1008, -122.630997),
    "YNL": (58.27669906616211, -104.08200073242188),
    "YNM": (49.76169967651367, -77.80280303955078),
    "YOA": (64.6988983154, -110.614997864),
    "YOD": (54.404998779296875, -110.27899932861328),
    "YOJ": (58.62139892578125, -117.16500091552734),
    "YOO": (43.922798, -78.894997),
    "YOP": (58.491402, -119.407997),
    "YOS": (44.5903015137, -80.8375015259),
    "YOW": (45.322498, -75.669197),
    "YPA": (53.214199066199996, -105.672996521),
    "YPS": (45.6567001343, -61.3680992126),
    "YPE": (56.226898, -117.446999),
    "YPG": (49.903099, -98.273817),
    "YPL": (51.4463996887207, -90.21420288085938),
    "YPN": (49.836399, -64.288597),
    "YPQ": (44.23, -78.363297),
    "YPR": (54.286098480199996, -130.445007324),
    "YPW": (49.83420181274414, -124.5),
    "YPX": (60.050598, -77.286903),
    "YPY": (58.7672004699707, -111.11699676513672),
    "YPZ": (54.3764, -125.950996),
    "YQA": (44.975376, -79.306546),
    "YQB": (46.7911, -71.393303),
    "YQD": (53.97140121459961, -101.09100341796875),
    "YQF": (52.182201, -113.893997),
    "YQG": (42.27560043334961, -82.95559692382812),
    "YQH": (60.116839, -128.821993),
    "YQI": (43.826900482177734, -66.08809661865234),
    "YQK": (49.788299560546875, -94.36309814453125),
    "YQL": (49.6302986145, -112.800003052),
    "YQM": (46.112202, -64.678596),
    "YQN": (50.18280029296875, -86.69640350341797),
    "YQQ": (49.7108, -124.887001),
    "YQR": (50.43190002441406, -104.66600036621094),
    "YQS": (42.77000045776367, -81.11080169677734),
    "YQT": (48.37189865112305, -89.32389831542969),
    "YQU": (55.1796989441, -118.885002136),
    "YQV": (51.26470184326172, -102.46199798583984),
    "YQW": (52.769409, -108.243742),
    "YQX": (48.936258, -54.567719),
    "YQY": (46.1614, -60.047798),
    "YQZ": (53.026100158691406, -122.51000213623047),
    "YRB": (74.7169036865, -94.9693984985),
    "YRI": (47.764400482177734, -69.58470153808594),
    "YRJ": (48.519665, -72.265735),
    "YRL": (51.066898345947266, -93.79309844970703),
    "YRO": (45.4603004456, -75.64610290530001),
    "YRQ": (46.35279846191406, -72.67939758300781),
    "YRT": (62.8114013672, -92.1157989502),
    "YRV": (50.962245, -118.184258),
    "YSB": (46.625, -80.79889678955078),
    "YSC": (45.438599, -71.691399),
    "YSF": (59.250301361083984, -105.84100341796875),
    "YSH": (44.945801, -75.940598),
    "YSJ": (45.31610107421875, -65.89029693603516),
    "YSL": (47.157097, -67.836242),
    "YSM": (60.020302, -111.961998),
    "YCM": (43.191598, -79.171686),
    "YSP": (48.75529861450195, -86.34439849853516),
    "YSU": (46.440601, -63.833599),
    "YTA": (45.86439895629883, -77.25170135498047),
    "YTF": (48.5089, -71.641899),
    "YTH": (55.80110168457031, -97.86419677734375),
    "YTR": (44.118900299072266, -77.5280990600586),
    "YTS": (48.569698333699996, -81.376701355),
    "YTZ": (43.627499, -79.396202),
    "YUL": (45.467837, -73.742294),
    "YUX": (68.7761, -81.2425),
    "YUY": (48.20610046386719, -78.83560180664062),
    "YVB": (48.071098, -65.460297),
    "YVC": (55.151401519800004, -105.262001038),
    "YVE": (50.246163, -119.330963),
    "YVO": (48.0532989502, -77.7827987671),
    "YVP": (58.096099853515625, -68.4269027709961),
    "YVQ": (65.28160095214844, -126.7979965209961),
    "YVR": (49.193901062, -123.183998108),
    "YVV": (44.7458, -81.107201),
    "YWA": (45.95220184326172, -77.31919860839844),
    "YWG": (49.909999847399995, -97.2398986816),
    "YWK": (52.92190170288086, -66.8644027709961),
    "YWL": (52.1831016541, -122.054000854),
    "YWY": (63.20940017700195, -123.43699645996094),
    "YXC": (49.610801696777, -115.78199768066),
    "YXE": (52.170799255371094, -106.69999694824219),
    "YXH": (50.018902, -110.721001),
    "YXJ": (56.238098, -120.739998),
    "YXK": (48.477644, -68.496323),
    "YXL": (50.11389923095703, -91.9052963256836),
    "YXQ": (62.410301208496094, -140.86700439453125),
    "YXR": (47.697400654599996, -79.8473453522),
    "YXS": (53.884311, -122.666554),
    "YXT": (54.468498, -128.576009),
    "YXU": (43.035599, -81.1539),
    "YXX": (49.025299, -122.361),
    "YXY": (60.709599, -135.067001),
    "YXZ": (47.96670150756836, -84.78669738769531),
    "YYB": (46.363602, -79.422798),
    "YYC": (51.118822, -114.009933),
    "YYD": (54.82469940185547, -127.18299865722656),
    "YYE": (58.8363990784, -122.597000122),
    "YYF": (49.46310043334961, -119.60199737548828),
    "YYG": (46.290000915527344, -63.12110137939453),
    "YYJ": (48.647201, -123.427792),
    "YYL": (56.86389923095703, -101.07599639892578),
    "YYN": (50.291900634799994, -107.691001892),
    "YYQ": (58.739200592041016, -94.06500244140625),
    "YYR": (53.3191986084, -60.4258003235),
    "YYT": (47.618599, -52.7519),
    "YYU": (49.411587, -82.469645),
    "YYW": (50.29029846191406, -88.90969848632812),
    "YYY": (48.60860061645508, -68.20809936523438),
    "YYZ": (43.6772, -79.6306),
    "YZE": (45.8853, -82.567802),
    "YZF": (62.462799, -114.440002),
    "YZH": (55.292945, -114.777276),
    "YZP": (53.25429916379999, -131.813995361),
    "YZR": (42.999401, -82.308899),
    "YZS": (64.1932983398, -83.3593978882),
    "YZT": (50.680599212646484, -127.36699676513672),
    "YZU": (54.143902, -115.787003),
    "YZV": (50.22330093383789, -66.2656021118164),
    "YZW": (60.17279815673828, -132.7429962158203),
    "YZX": (44.98440170288086, -64.91690063476562),
    "YSN": (50.682802, -119.228996),
    "YDT": (49.0742, -123.012001),
    "ZBF": (47.6297, -65.738899),
    "ZBM": (45.290798, -72.741402),
    "KES": (56.0374984741, -96.50969696039999),
    "ZFA": (62.20750045776367, -133.37600708007812),
    "ZGF": (49.015598, -118.431),
    "ZJG": (54.51890182495117, -98.04609680175781),
    "ZJN": (52.120602, -101.236),
    "YTD": (55.31890106201172, -97.70780181884766),
    "PIW": (55.58890151977539, -97.16419982910156),
    "ZMT": (54.0275, -132.125),
    "WPC": (49.520429, -113.997002),
    "ZSJ": (53.06420135498047, -93.34439849853516),
    "ZST": (55.935410448, -129.982434511),
    "ZUC": (49.428204, -91.720418),
    "QLD": (36.503601, 2.81417),
    "BUJ": (35.3325, 4.20639),
    "BJA": (36.711952, 5.069804),
    "ALG": (36.693886, 3.214531),
    "DJG": (24.292801, 9.45244),
    "VVZ": (26.723499, 8.62265),
    "QSF": (36.178100585900005, 5.3244900703399995),
    "TMR": (22.811501, 5.45108),
    "GJL": (36.795101, 5.87361),
    "MZW": (33.535900116, -0.242353007197),
    "AAE": (36.826781, 7.81334),
    "CZL": (36.2760009765625, 6.620389938354492),
    "TEE": (35.4315986633, 8.12071990967),
    "BLJ": (35.752102, 6.30859),
    "HRM": (32.930401, 3.31154),
    "TID": (35.341099, 1.46315),
    "TIN": (27.7003993988, -8.167099952700001),
    "CFK": (36.217166, 1.342237),
    "TAF": (35.5424, -0.532278),
    "TLM": (35.013426, -1.457191),
    "ORN": (35.623901, -0.621183),
    "CBH": (31.645700454711914, -2.269860029220581),
    "MUW": (35.207699, 0.147142),
    "AZR": (27.837601, -0.186414),
    "BSK": (34.793301, 5.73823),
    "ELG": (30.580732, 2.861595),
    "GHA": (32.384102, 3.79411),
    "HME": (31.673, 6.14044),
    "INZ": (27.250999, 2.51202),
    "TGR": (33.067799, 6.08867),
    "LOO": (33.7644, 2.92834),
    "ELU": (33.511398, 6.77679),
    "TMX": (29.237101, 0.276033),
    "OGX": (31.9172, 5.41278),
    "IAM": (28.0515, 9.64291),
    "COO": (6.357230186462402, 2.384350061416626),
    "OUA": (12.3532, -1.51242),
    "BOY": (11.160099983215332, -4.33096981048584),
    "ACC": (5.605189800262451, -0.16678600013256073),
    "TML": (9.55718994140625, -0.8632140159606934),
    "KMS": (6.714560031890869, -1.5908199548721313),
    "NYI": (7.36183, -2.32876),
    "TKD": (4.896059989929199, -1.7747600078582764),
    "ABJ": (5.26139, -3.92629),
    "BYK": (7.7388, -5.07367),
    "DJO": (6.79281, -6.47319),
    "HGO": (9.38718, -5.55666),
    "MJC": (7.27207, -7.58736),
    "SPY": (4.74672, -6.66082),
    "ASK": (6.9031701088, -5.36558008194),
    "ABV": (9.00679, 7.26317),
    "QUO": (4.8725, 8.093),
    "AKR": (7.246739864349365, 5.3010101318359375),
    "ABB": (6.204167, 6.665278),
    "BCU": (10.482833, 9.744),
    "BNI": (6.316979885101318, 5.5995001792907715),
    "CBQ": (4.976019859313965, 8.347200393676758),
    "ENU": (6.474269866943359, 7.561960220336914),
    "GMO": (10.298889, 10.9),
    "QUS": (12.1717, 6.69611),
    "IBA": (7.362460136413574, 3.97832989692688),
    "ILR": (8.440210342407227, 4.493919849395752),
    "QOW": (5.427060127258301, 7.206029891967773),
    "JOS": (9.639829635620117, 8.869050025939941),
    "KAD": (10.696000099182129, 7.320109844207764),
    "KAN": (12.0476, 8.52462),
    "MIU": (11.855299949645996, 13.080900192260742),
    "MDI": (7.70388, 8.61394),
    "LOS": (6.57737, 3.32116),
    "MXJ": (9.652170181274414, 6.462259769439697),
    "PHC": (5.0154900550842285, 6.94959020614624),
    "SKO": (12.916299819946289, 5.207190036773682),
    "QRW": (5.59821, 5.8187),
    "YOL": (9.257550239562988, 12.430399894714355),
    "ZAR": (11.1302, 7.68581),
    "MFQ": (13.5025, 7.12675),
    "NIM": (13.4815, 2.18361),
    "THZ": (14.8757, 5.26536),
    "AJY": (16.965999603271484, 8.000109672546387),
    "ZND": (13.779000282287598, 8.983759880065918),
    "TBJ": (36.98, 8.87694),
    "MIR": (35.75809860229492, 10.75469970703125),
    "NBE": (36.075833, 10.438611),
    "TUN": (36.851002, 10.2272),
    "GAF": (34.422000885009766, 8.822500228881836),
    "GAE": (33.733691, 9.91941),
    "DJE": (33.875, 10.7755),
    "EBM": (31.7043, 9.25462),
    "SFA": (34.71799850463867, 10.690999984741211),
    "TOE": (33.939701080322266, 8.110560417175293),
    "LRL": (9.767330169677734, 1.091249942779541),
    "LFW": (6.16561, 1.25451),
    "ANR": (51.190667, 4.463153),
    "BRU": (50.901402, 4.48444),
    "CRL": (50.460982, 4.457158),
    "KJK": (50.818878, 3.209551),
    "LGG": (50.638574, 5.443897),
    "OST": (51.1998, 2.874673),
    "AOC": (50.981945, 12.506389),
    "HDF": (53.8787, 14.1523),
    "FNB": (53.6022, 13.306),
    "BER": (52.362247, 13.500672),
    "DRS": (51.134123, 13.767831),
    "ERF": (50.979801, 10.9581),
    "FRA": (50.030241, 8.561096),
    "FMO": (52.134602, 7.68483),
    "HAM": (53.630402, 9.98823),
    "CGN": (50.865898, 7.14274),
    "DUS": (51.289501, 6.76678),
    "MUC": (48.353802, 11.7861),
    "NUE": (49.498699, 11.078056),
    "LEJ": (51.420657, 12.232705),
    "SCN": (49.214599609400004, 7.10950994492),
    "STR": (48.689899, 9.22196),
    "HAJ": (52.461102, 9.68508),
    "BRE": (53.046786, 8.78932),
    "HHN": (49.9487, 7.26389),
    "MHG": (49.473057, 8.514167),
    "EIB": (50.991604, 10.47973),
    "SGE": (50.707699, 8.08297),
    "XFW": (53.5352783203125, 9.835556030273438),
    "KEL": (54.37957, 10.145266),
    "LBC": (53.805401, 10.7192),
    "FMM": (47.988800048799995, 10.2395000458),
    "MGL": (51.230278, 6.504444),
    "PAD": (51.614101, 8.61632),
    "NRN": (51.6024017334, 6.14216995239),
    "DTM": (51.518299, 7.61224),
    "AGB": (48.425278, 10.931667),
    "OBF": (48.081402, 11.2831),
    "FDH": (47.671299, 9.51149),
    "BYU": (49.985001, 11.64),
    "HOQ": (50.288544, 11.852876),
    "FKB": (48.7794, 8.0805),
    "LHA": (48.369301, 7.82772),
    "BWE": (52.319199, 10.5561),
    "KSF": (51.420699, 9.392152),
    "GWT": (54.9132, 8.34047),
    "KDL": (58.99079895019531, 22.830699920654297),
    "URE": (58.22990036010742, 22.50950050354004),
    "EPU": (58.41899871826172, 24.47279930114746),
    "EES": (23.980437, 35.460277),
    "TLL": (59.413246, 24.83264),
    "TAY": (58.307438, 26.686473),
    "ENF": (68.362602233887, 23.424299240112),
    "KEV": (61.856039, 24.786686),
    "HEL": (60.318363, 24.963341),
    "KTQ": (62.1661, 30.073601),
    "IVL": (68.607299804688, 27.405300140381),
    "JOE": (62.658815, 29.619398),
    "JYV": (62.399502, 25.678301),
    "KAU": (63.127102, 23.051399),
    "KEM": (65.778701782227, 24.582099914551),
    "KAJ": (64.2855, 27.6924),
    "KHJ": (62.463212, 22.390817),
    "KOK": (63.721199, 23.143101),
    "KAO": (65.987602, 29.239401),
    "KTT": (67.700996398926, 24.846799850464),
    "KUO": (63.007099, 27.7978),
    "LPP": (61.044601, 28.144743),
    "MHQ": (60.1222, 19.898199),
    "MIK": (61.6866, 27.201799),
    "OUL": (64.930099, 25.354601),
    "POR": (61.4617, 21.799999),
    "RVN": (66.564796447754, 25.830400466919),
    "SVL": (61.9431, 28.945101),
    "SJY": (62.692101, 22.8323),
    "SOT": (67.3949966431, 26.6191005707),
    "TMP": (61.414101, 23.604401),
    "TKU": (60.514099, 22.2628),
    "UTI": (60.8964, 26.9384),
    "VAA": (63.050701, 21.762199),
    "VRK": (62.171101, 27.868601),
    "YLI": (64.054722, 24.725278),
    "BFS": (54.6575012207, -6.2158298492399995),
    "ENK": (54.398899, -7.65167),
    "BHD": (54.618099, -5.8725),
    "LDY": (55.04280090332031, -7.161109924316406),
    "BHX": (52.453899, -1.74803),
    "CVT": (52.369701, -1.47972),
    "GLO": (51.89419937133789, -2.167220115661621),
    "NQT": (52.919998, -1.07917),
    "MAN": (53.349375, -2.279521),
    "YEO": (51.009399, -2.63882),
    "CAL": (55.437198638916016, -5.686389923095703),
    "EOI": (59.19060134887695, -2.7722198963165283),
    "HAW": (51.833099365234375, -4.9611101150512695),
    "CWL": (51.396702, -3.34333),
    "SWS": (51.601366, -4.071006),
    "BRS": (51.382702, -2.71909),
    "LPL": (53.333599, -2.84972),
    "LTN": (51.874699, -0.368333),
    "BOH": (50.780483, -1.839576),
    "SOU": (50.950298, -1.3568),
    "NQY": (50.440601, -4.99541),
    "ACI": (49.706104, -2.21472),
    "GCI": (49.435001, -2.60197),
    "JER": (49.20790100097656, -2.195509910583496),
    "ESH": (50.835602, -0.297222),
}

# Precompute coordinates in radians for faster calculations
_RAD = {
    code: (radians(lat), radians(lon)) for code, (lat, lon) in AIRPORTS.items()
}

# Average Earth radius in kilometers used for distance calculations
EARTH_RADIUS_KM = 6371.0


# https://en.wikipedia.org/wiki/Haversine_formula


def distance_km(orig: str, dest: str) -> float:
    """Return great-circle distance between two IATA airports in kilometers."""
    try:
        rlat1, rlon1 = _RAD[orig.upper()]
        rlat2, rlon2 = _RAD[dest.upper()]
    except KeyError as exc:
        raise KeyError(f"Unknown IATA code: {exc.args[0]}") from None

    dlat = rlat2 - rlat1
    dlon = rlon2 - rlon1
    a = sin(dlat / 2) ** 2 + cos(rlat1) * cos(rlat2) * sin(dlon / 2) ** 2
    c = 2 * atan2(sqrt(a), sqrt(1 - a))
    return EARTH_RADIUS_KM * c


__all__ = ["distance_km", "AIRPORTS", "_RAD", "EARTH_RADIUS_KM"]
